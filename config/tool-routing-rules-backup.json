{
  "version": "2.2.0",
  "lastUpdated": "2025-01-13",
  "sessionManagement": {
    "autoStart": {
      "tool": "check-sap-authentication",
      "when": "session_start",
      "automatic": true,
      "description": "Automatically validates authentication at the beginning of each session"
    },
    "primaryEntryPoint": {
      "tool": "sap-smart-query",
      "description": "Universal router - ALWAYS use this for ANY SAP request",
      "handles": ["natural_language", "odata_queries", "analytics", "realtime", "all_requests"],
      "mandatory": true,
      "note": "ALL requests must go through this entry point for optimal routing"
    }
  },
  "fallbackRouting": {
    "unknownRequest": {
      "primary": "search-sap-services",
      "description": "When user intent is unclear, start with service discovery",
      "viaRouter": true
    },
    "authenticationFailure": {
      "primary": "check-sap-authentication",
      "description": "Redirect to authentication when auth fails",
      "automatic": true
    },
    "performanceIssue": {
      "primary": "query-performance-optimizer",
      "description": "Route to optimizer when queries are slow",
      "viaRouter": true
    },
    "dataNotFound": {
      "primary": "search-sap-services",
      "description": "Start discovery flow when data sources are unknown",
      "viaRouter": true
    }
  },
  "toolSelectionRules": {
    "note": "All requests should go through sap-smart-query for intelligent routing",
    "directQueryPatterns": [
      "\\$filter=",
      "\\$select=",
      "\\$expand=",
      "\\$top=",
      "\\$skip=",
      "Set\\?"
    ]
  },
  "toolPriorities": {
    "universalRouter": {
      "primary": "sap-smart-query",
      "description": "Primary entry point for ALL requests",
      "authRequired": false
    },
    "naturalLanguage": {
      "primary": "natural-query-builder",
      "fallback": "execute-entity-operation",
      "authRequired": false,
      "routedBy": "sap-smart-query"
    },
    "directQuery": {
      "primary": "execute-entity-operation", 
      "authRequired": true
    },
    "performance": {
      "primary": "query-performance-optimizer",
      "authRequired": true
    },
    "process": {
      "primary": "business-process-insights",
      "authRequired": true
    },
    "realtime": {
      "primary": "realtime-data-stream",
      "authRequired": false
    },
    "dashboard": {
      "primary": "kpi-dashboard-builder",
      "authRequired": true
    },
    "predictive": {
      "primary": "predictive-analytics-engine",
      "authRequired": false
    },
    "intelligence": {
      "primary": "business-intelligence-insights",
      "authRequired": false
    }
  },
  "workflowSequences": {
    "sessionInitialization": [
      {
        "step": 0,
        "tool": "check-sap-authentication",
        "auth": false,
        "automatic": true,
        "when": "session_start",
        "description": "Automatic authentication check at session start"
      },
      {
        "step": 1,
        "tool": "sap-smart-query",
        "auth": false,
        "mandatory": true,
        "description": "Primary entry point for all subsequent requests"
      }
    ],
    "universalEntry": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "mandatory": true,
        "description": "Universal entry point - routes to appropriate workflow",
        "note": "ALL workflows start here"
      }
    ],
    "discovery": [
      {
        "step": 1,
        "tool": "search-sap-services",
        "auth": false,
        "mandatory": true,
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "discover-service-entities",
        "auth": false,
        "mandatory": true
      },
      {
        "step": 3,
        "tool": "get-entity-schema",
        "auth": false,
        "condition": "schema needed"
      },
      {
        "step": 4,
        "tool": "natural-query-builder",
        "auth": false,
        "condition": "natural language query"
      },
      {
        "step": 5,
        "tool": "execute-entity-operation",
        "auth": true,
        "mandatory": true
      },
      {
        "step": 6,
        "tool": "smart-data-analysis",
        "auth": true,
        "condition": "analysis requested"
      }
    ],
    "directExecution": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to direct execution"
      },
      {
        "step": 1,
        "tool": "execute-entity-operation",
        "auth": true,
        "mandatory": true,
        "routedBy": "sap-smart-query"
      }
    ],
    "businessProcessAnalysis": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to business process analysis"
      },
      {
        "step": 1,
        "tool": "search-sap-services",
        "auth": false,
        "condition": "serviceId unknown",
        "description": "Find relevant SAP services for process analysis",
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "discover-service-entities",
        "auth": false,
        "condition": "entityType unknown",
        "description": "Identify process-related entities"
      },
      {
        "step": 3,
        "tool": "execute-entity-operation",
        "auth": true,
        "mandatory": true,
        "description": "Extract historical process data"
      },
      {
        "step": 4,
        "tool": "business-process-insights",
        "auth": true,
        "mandatory": true,
        "description": "Analyze process for bottlenecks and optimization opportunities"
      }
    ],
    "performanceOptimization": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to performance optimization"
      },
      {
        "step": 1,
        "tool": "query-performance-optimizer",
        "auth": true,
        "mandatory": true,
        "description": "Analyze query performance and generate optimization recommendations",
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "execute-entity-operation",
        "auth": true,
        "mandatory": true,
        "description": "Execute optimized query to verify performance improvements"
      }
    ],
    "realtimeAnalytics": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to real-time analytics"
      },
      {
        "step": 1,
        "tool": "realtime-data-stream",
        "auth": false,
        "mandatory": true,
        "description": "Initialize WebSocket streaming for real-time data",
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "kpi-dashboard-builder",
        "auth": true,
        "condition": "dashboard needed",
        "description": "Create KPI dashboard for real-time visualization"
      },
      {
        "step": 3,
        "tool": "business-intelligence-insights",
        "auth": false,
        "condition": "insights needed",
        "description": "Generate automated insights from streaming data"
      }
    ],
    "predictiveAnalytics": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to predictive analytics"
      },
      {
        "step": 1,
        "tool": "search-sap-services",
        "auth": false,
        "condition": "serviceId unknown",
        "description": "Find relevant services for predictive modeling",
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "execute-entity-operation",
        "auth": true,
        "condition": "historical data needed",
        "description": "Extract historical data for model training"
      },
      {
        "step": 3,
        "tool": "predictive-analytics-engine",
        "auth": false,
        "mandatory": true,
        "description": "Generate ML-powered predictions and forecasts"
      },
      {
        "step": 4,
        "tool": "business-intelligence-insights",
        "auth": false,
        "condition": "insights needed",
        "description": "Analyze predictions and generate actionable insights"
      }
    ],
    "dashboardCreation": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to dashboard creation"
      },
      {
        "step": 1,
        "tool": "search-sap-services",
        "auth": false,
        "condition": "serviceId unknown",
        "description": "Find relevant data services for dashboard",
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "execute-entity-operation",
        "auth": true,
        "condition": "data needed",
        "description": "Extract data for dashboard KPIs"
      },
      {
        "step": 3,
        "tool": "kpi-dashboard-builder",
        "auth": true,
        "mandatory": true,
        "description": "Create and configure KPI dashboard"
      },
      {
        "step": 4,
        "tool": "realtime-data-stream",
        "auth": false,
        "condition": "real-time updates needed",
        "description": "Enable real-time data updates for dashboard"
      }
    ],
    "comprehensiveBusinessIntelligence": [
      {
        "step": 0,
        "tool": "sap-smart-query",
        "auth": false,
        "description": "Routes to comprehensive business intelligence"
      },
      {
        "step": 1,
        "tool": "search-sap-services",
        "auth": false,
        "condition": "serviceId unknown",
        "description": "Discover relevant data sources for comprehensive analysis",
        "routedBy": "sap-smart-query"
      },
      {
        "step": 2,
        "tool": "execute-entity-operation",
        "auth": true,
        "condition": "data extraction needed",
        "description": "Extract comprehensive business data for analysis"
      },
      {
        "step": 3,
        "tool": "business-intelligence-insights",
        "auth": false,
        "mandatory": true,
        "description": "Generate comprehensive business insights and recommendations"
      },
      {
        "step": 4,
        "tool": "predictive-analytics-engine",
        "auth": false,
        "condition": "forecasting needed",
        "description": "Add predictive analytics to insights"
      },
      {
        "step": 5,
        "tool": "kpi-dashboard-builder",
        "auth": true,
        "condition": "visualization needed",
        "description": "Create executive dashboard with key insights"
      }
    ]
  },
  "toolCategories": {
    "entryPoints": {
      "tools": ["check-sap-authentication", "sap-smart-query"],
      "count": 2,
      "description": "Session initialization and universal routing"
    },
    "discoveryAndQueryBuilding": {
      "tools": ["search-sap-services", "discover-service-entities", "get-entity-schema", "natural-query-builder"],
      "count": 4,
      "authRequired": false,
      "description": "Service discovery and query construction"
    },
    "executionAndAnalysis": {
      "tools": ["execute-entity-operation", "smart-data-analysis", "business-process-insights", "query-performance-optimizer"],
      "count": 4,
      "authRequired": true,
      "description": "Data execution and advanced analysis"
    },
    "realtimeAndIntelligence": {
      "tools": ["realtime-data-stream", "predictive-analytics-engine", "business-intelligence-insights", "kpi-dashboard-builder"],
      "count": 4,
      "authRequired": "mixed",
      "noAuth": ["realtime-data-stream", "predictive-analytics-engine", "business-intelligence-insights"],
      "authRequired_tools": ["kpi-dashboard-builder"],
      "description": "Real-time streaming, ML predictions, and dashboards"
    }
  },
  "authenticationRules": {
    "noAuthRequired": [
      "check-sap-authentication",
      "sap-smart-query",
      "search-sap-services",
      "discover-service-entities", 
      "get-entity-schema",
      "natural-query-builder",
      "realtime-data-stream",
      "predictive-analytics-engine",
      "business-intelligence-insights"
    ],
    "authRequired": [
      "execute-entity-operation",
      "smart-data-analysis",
      "business-process-insights",
      "query-performance-optimizer",
      "kpi-dashboard-builder"
    ]
  }
}