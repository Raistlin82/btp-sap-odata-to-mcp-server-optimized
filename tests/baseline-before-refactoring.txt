
> btp-sap-odata-to-mcp-server@1.0.0 test:mcp:working
> node tests/test-mcp-tools-working.js


🔧 WORKING MCP TOOLS TEST
==========================

ℹ 🔧 Testing MCP Server with proper protocol handshake
🔍 🚀 Starting MCP server for protocol test...
🔍 Server stderr: SAP Logging not available, using fallback
...
🔍 Server stderr: {"component":"CloudLoggingService","jse_info":{},"jse_shortmsg":"No service matches logging","level":"warn","message":"⚠️  Failed to initialize SAP Cloud Logging, using fallback: No service matches lo...
🔍 Server stderr: {"component":"AuthServer","level":"info","message":"✅ AuthServer constructor completed successfully","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.161Z"}
...
🔍 Server stderr: {"component":"btp-sap-odata-to-mcp-server","level":"info","message":"✅ Auth server initialized successfully","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.161Z"}
...
🔍 Server stderr: {"component":"btp-sap-odata-to-mcp-server","level":"info","message":"✅ Health monitoring service initialized","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.161Z"}
...
🔍 Server stderr: {"component":"sap-mcp-server","level":"info","message":"🚀 Starting SAP MCP Server in stdio mode with PRODUCTION authentication...","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:3...
🔍 Server stderr: {"component":"sap-mcp-server","level":"info","message":"🔐 Initializing SAP Authentication:","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.163Z"}
...
🔍 Server stderr: {"component":"sap-mcp-server","level":"info","message":"   - TokenStore: true","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.163Z"}
{"component":"sap-mcp-server","level":"in...
🔍 Server stderr: {"component":"sap-mcp-server","level":"error","message":"Failed to get design-time destination 'SAP_SYSTEM': Could not find service binding of type 'destination'.","service":"btp-sap-odata-to-mcp-serv...
🔍 Server stderr: {"component":"sap-mcp-server","level":"error","message":"Request failed: Could not find service binding of type 'destination'.","service":"btp-sap-odata-to-mcp-server","stack":"Error: Could not find s...
🔍 Server stderr: {"component":"sap-mcp-server","level":"error","message":"❌ Failed to initialize SAP Authentication: Could not find service binding of type 'destination'.","service":"btp-sap-odata-to-mcp-server","stac...
🔍 Server stderr: {"component":"sap-mcp-server","level":"info","message":"🔄 Falling back to basic mode without authentication...","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.165Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"warn","message":"⚠️  MCPAuthManager NOT initialized - tokenStore: false, authServerUrl: undefined","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"📜 Registering MCP resources for document grounding","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.166Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"✅ MCP Document Grounding Resources registered: sap://routing-rules, sap://service/{id}/metadata, sap://services","service":"btp-sap-odata-to-mcp-ser...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"🔧 Registering hierarchical tools for 0 services","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.166Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"✅ Registered 4 hierarchical discovery tools successfully","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.166Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"✅ Registered Authentication Check Tool: check-sap-authentication","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"✅ Registered Smart Router Tool: sap-smart-query","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"🤖 AI-Enhanced tools temporarily disabled for TypeScript fixes","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"🤖 Registering AI-Enhanced tools for intelligent SAP operations","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"🔄 Registering Phase 3: Real-time Analytics tools","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"✅ Registered 4 Real-time Analytics tools: realtime-data-stream, kpi-dashboard-builder, predictive-analytics-engine, business-intelligence-insights",...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"✅ Registered 8 AI-Enhanced tools: 4 Phase 2 + 4 Phase 3 Real-time Analytics tools","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T0...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"🎯 TOTAL TOOLS REGISTERED: 12 (4 Discovery + 4 AI Phase 2 + 4 Real-time Phase 3)","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08...
🔍 Server stderr: {"component":"mcp-server","level":"info","message":"📡 Connected to stdio transport","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 Server stderr: {"component":"sap-mcp-server","level":"info","message":"SAP MCP Server running on stdio...","service":"btp-sap-odata-to-mcp-server","timestamp":"2025-09-16T08:31:22.167Z"}
...
🔍 📤 Sending: initialize
🔍 📥 Received response for: 1
🔍 ✅ Server initialized with capabilities
🔍 📤 Sending: tools/list
🔍 📥 Received response for: 1
🔍 📥 Received response for: 2
🔍 ✅ Got 14 tools from server
✅ ✅ MCP Protocol Test: PASSED

📊 RESULTS SUMMARY:
✅ Passed: 1
❌ Failed: 0

📋 Test: MCP Protocol Test
   ✅ Status: SUCCESS
   🔧 Tools Found: 14
   📝 Tools List: search-sap-services, discover-service-entities, get-entity-schema, execute-entity-operation, check-sap-authentication, sap-smart-query, natural-query-builder, smart-data-analysis, query-performance-optimizer, business-process-insights, realtime-data-stream, kpi-dashboard-builder, predictive-analytics-engine, business-intelligence-insights
   📡 Completed Steps: initialize → tools_list

🎉 MCP SERVER IS WORKING!
The server can communicate via MCP protocol and serves tools correctly.
